constexpr char HtmlFile[] = "<!DOCTYPE html>\n<html>\n\n<head>\n\t<meta charset=\"utf-8\">\n\t<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n\t<title>文件管理</title>\n</head>\n\n<body>\n\t<div>\n\t\t<input type=\"file\" id=\"fileUploadInput\" />\n\t\t<br />\n\t\t<button id=\"fileUploadButton\" multiple>上传至此处</button>\n\t\t<button id=\"refresh\" multiple>刷新</button>\n\t</div>\n\t<br />\n\t<div>\n\t\t<input type=\"text\" id=\"newFloorNameInput\" />\n\t\t<br />\n\t\t<button id=\"newFloorButton\" multiple>新建文件夹</button>\n\t</div>\n\t<p id=\"space\">剩余空间/总空间:0/0(100%)</p>\n\t<div id=\"explorer\">\n\t\t正在加载...\n\t</div>\n</body>\n\n<script>\n\tlet fileUploadElement = document.getElementById(\"fileUploadInput\");\n\tlet newFloorElement = document.getElementById(\"newFloorNameInput\");\n\tlet fileExplorerElement = document.getElementById(\"explorer\");\n\tlet spaceElement = document.getElementById(\"space\");\n\n\tlet place = \"/\";\n\tconst splitChar = '\\n';\n\n\tfunction cd(path) {\n\t\tif (path[path.length - 1] != '/') return;\n\t\tif (path == '../') {\n\t\t\tvar i = place.length;\n\t\t\twhile (i >= 0) {\n\t\t\t\tif (place[i] == '/') break;\n\t\t\t\telse i--;\n\t\t\t}\n\t\t\ti--;\n\t\t\twhile (i >= 0) {\n\t\t\t\tif (place[i] == '/') break;\n\t\t\t\telse i--;\n\t\t\t}\n\t\t\ti++;\n\t\t\tif (i <= 0) place = \"/\";\n\t\t\telse place = place.substring(0, i);\n\t\t}\n\t\telse {\n\t\t\tplace += path.toString();\n\t\t}\n\t\tload();\n\t}\n\n\tfunction deleteFile(path) {\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open(\"DELETE\", place + path);\n\t\trequest.onload = load;\n\t\trequest.send(place + path);\n\t}\n\n\tfunction deletePath(path) {\n\t\tif (path == \"/\") return;\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open(\"DELETE\", place);\n\t\trequest.onload = cd(\"../\");\n\t\trequest.send(place);\n\t}\n\n\tfunction spaceUpdate(spaces) {\n\t\tvar free = spaces[0];\n\t\tvar totol = spaces[1];\n\n\t\tspaceElement.innerHTML = \"剩余空间(KiB)/总空间(KiB):\";\n\t\tspaceElement.innerHTML += (free / 1000).toString() + '/' + (totol / 1000).toString();\n\t\tspaceElement.innerHTML += \"(\" + (free * 100 / totol).toString() + \"%)\";\n\t}\n\n\tfunction getSpace() {\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open(\"POST\", \"/api/getSpace\");\n\t\trequest.onload = function () { spaceUpdate(this.responseText.split(',')); };\n\t\trequest.send(\"\");\n\t}\n\n\tfunction update(files) {\n\n\t\tif (files[0] == \"\" && place != \"/\") {\n\t\t\texplorer.innerHTML = (\"<button onclick=\\'cd(\\\"../\\\")\\'>\" + place.toString() + \"</button> <button onclick='deletePath(\\\"\" + place.toString() + \"\\\")'>删除文件夹</button>\");\n\t\t\treturn;\n\t\t}\n\t\texplorer.innerHTML = \"<button onclick='cd(\\\"../\\\")'>\" + place.toString() + \"</button><br/>\";\n\n\t\tlet file = \"\";\n\t\tfor (i = 0; i < files.length; i++) {\n\t\t\tif (files[i][files[i].length - 1] == '/') {\n\t\t\t\tfile = \"<button onclick='cd(\\\"\" + files[i].toString() + \"\\\")'>\"\n\t\t\t\t\t+ files[i].toString() + \"</button> <br/>\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfile = \"<button onclick='window.open(\\\"/file\" + place + files[i].toString() + \"\\\")'>\"\n\t\t\t\t\t+ files[i].toString() + \"</button> \";\n\t\t\t\tfile += \"<button onclick='deleteFile(\\\"\" + files[i].toString() + \"\\\")'>删除</button> <br/>\";\n\t\t\t}\n\t\t\texplorer.innerHTML += file;\n\t\t}\n\t}\n\n\tfunction load() {\n\t\texplorer.innerHTML = \"正在读取\\\"\" + place.toString() + \"\\\"中的文件\";\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open(\"POST\", \"/api/floor\");\n\t\trequest.onload = function () { update(this.responseText.split(splitChar)); };\n\t\trequest.send(place);\n\t\tgetSpace();\n\t}\n\n\tfunction upload(place, value) {\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open(\"PUT\", place);\n\t\trequest.onload = load;\n\t\trequest.send(value);\n\t}\n\n\tfunction uploadPressed() {\n\t\tlet file = fileUploadElement.files[0];\n\t\tlet reader = new FileReader();\n\t\tlet path = place;\n\t\tpath += file.name;\n\t\treader.onload = function Fileloaded() {\n\t\t\tupload(path, this.result);\n\t\t}\n\t\treader.readAsArrayBuffer(file);\n\t}\n\n\tfunction newFloor() {\n\t\tlet path = newFloorElement.value.toString();\n\t\tif (path.includes(\"/\")) {\n\t\t\tconsole.log(\"path: \\\"\" + path + \"\\\" is invalid\");\n\t\t\treturn;\n\t\t}\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open(\"PUT\", place.toString() + path + \"/\");\n\t\trequest.onload = load;\n\t\trequest.send(\"\");\n\t}\n\n\tdocument.getElementById(\"fileUploadButton\").addEventListener(\"click\", uploadPressed);\n\tdocument.getElementById(\"newFloorButton\").addEventListener(\"click\", newFloor);\n\tdocument.getElementById(\"refresh\").addEventListener(\"click\", load);\n\tload();\n\tconsole.log(\"\\\"file.js\\\" loaded\");\n</script>\n\n<style>\n\ta:link {\n\t\ttext-decoration: none;\n\t}\n\n\ta:visited {\n\t\ttext-decoration: none;\n\t}\n\n\ta:hover {\n\t\ttext-decoration: underline;\n\t}\n\n\ta:active {\n\t\ttext-decoration: underline;\n\t}\n\n\tbody {\n\t\tbackground-color: #c2dadf;\n\t}\n</style>\n\n</html>";